Транзакция - логическая единица работы веб-приложения, которая включает в себя все операции от момента получения веб-запроса до отправки ответа.

В APM транзакции делятся на 2 типа: Web и Other.
- Web-транзакции возникают при обработке HTTP-запросов, таких как загрузка страниц или выполнение API-запросов.
- Транзакции Other создаются при выполнении фоновых задач, запланированных заданий или обработке сообщений.

Метрики делятся на 2 типа:
- **Метрики приложения**: включают количество обработанных запросов, длительность обработки, число ошибок, Apdex. Эти метрики собираются для всего приложения и для отдельных транзакций. Есть и другие, например, CPU utilization и Memory usage.
- **Метрики транзакций**: фиксируют длительность операций внутри каждой транзакции.
  Операции делятся на 2 типа:
  - External операции происходят при взаимодействии вашего приложения с внешними системами, такими как API других сервисов, базы данных или сторонние службы.
  - Datasource операции происходят при обращении к базам данных.

Также некоторая статистика вычисляется на основе событий. Подробнее о метриках и событиях можно прочесть в [документации по модели данных](data_model.md).

При переходе на APM приложение по умолчанию открывается дашборд Web-транзакций, но также есть и дашборд Other-транзакций. Оба этих дашборда имеют одинаковую струкутуру, за исключением того, что в Web-транзакциях также есть метрики Apdex

## Стуктура дашбордов Web/Other транзакций

;;;;; ![your_app](images/img1.png)

На дашборде транзакций есть панели:

- Время ответа сервиса на web-запросы (среднее с детализацией и с разбивкой по перцентилям)
- Ключевые метрики здоровья системы (ошибки, пропускная способность (throughput), APDEX)
- Метрики с разбивкой по хостам
- ТОП транзакций в системе
- Сравнение с историческими данными (сутки и неделю назад)

**Apdex** (Application Performance Index) - это индекс, показывающий отношение  количество "удовлетворительно" отработавших транзакций (по времени) к общему количеству запросов. Метрика варьируется от 0 до 1:
* Apdex = 1 означает, что все запросы удовлетворяют ожиданиям пользователей (satisfied). Время ответа сервера находится в пределах "удовлетворительного" диапазона для всех запросов.
* Apdex более 0.7 означает, что в системе есть множество tolerated запросов.
* Apdex = 0 означает, что все запросы неудовлетворительны (frustrated). Это указывает на то, что время ответа значительно выше ожидаемого, и пользователи испытывают проблемы с производительностью сервиса.

Satisfied считаются запросы обработанные без ошибок и менее, чем за лимит, который по умолчанию 500мс. Tolerated до четырехкратного превышения лимита, остальные считаются frustrated. Данный лимит можно изменить в настройках APM агента переменной `NEW_RELIC_APDEX_T`

**Throughput** - пропускная способность, метрика пользовательской активности, для APM измеряется в requests per minute (RPM) и также на графике выводится частота satisfied, tolerated и frustrated запросов.

**Percentilies** - показатель позволяющий увидеть, какой процент запросов выполняется быстрее или медленнее определенного порога. Это полезно для понимания того, как долго пользователи ждут ответа от приложения, и помогает выявить узкие места в производительности.
- 95-й перцентиль показывает, что 95% запросов выполняются быстрее или равны этому значению, тогда как 5% выполняются медленнее.
- 99-й перцентиль аналогично: только 99% выполняются быстрее него и только лишь 1% запросов медленнее или равны ему

Перцентили помогают лучше понять распределение производительности приложения по сравнению со средним значением. Это особенно важно, если есть большое количество запросов, которые выполняются очень быстро, но также присутствуют редкие события с очень длительным временем отклика: среднее значение может сильно отклониться, но, например, 99-я перцентиль нет, это будет значить, что очень медленные запросы составляют лишь 1 или менее процента от общего числа запросов.

**Transactions** - список транзакций ведущий на дашборд метрик по конкретным транзакиям и разбивка суммарного времени обработки запросов по транзакциям

**Status codes** - статус коды, которые собираются в рамках транзакций, на графике отображено количество запросов в минуту. Полагаясь на время возникновения, переходим в транзакции для дальнейшего расследования, если видим коды кроме 200.

## Стуктура дашборда конкретных транзакций

