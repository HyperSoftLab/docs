# Инструкция по обновлению GMonit до актуальной версии

## Шаг 1: Перейдите в каталог GMonit

```bash
cd /home/user/gmonit
# или
cd gmonit
````

---

## Шаг 2: Обновите версию в `.env`

1. Откройте файл `.env`:

   ```bash
   nano .env
   ```

2. Найдите строку с `TAG`:

   * Закомментируйте текущую строку со старой версией:

     ```env
     # TAG=v3-3822
     ```
   * Добавьте строку с актуальной версией (смотрите актуальный релиз на [docs.gmonit.ru → Releases](https://docs.gmonit.ru/#/releases)):

     ```env
     TAG=v3-4181
     ```

3. Сохраните файл и выйдите из редактора.

---

## Шаг 3: Обновите образы и перезапустите контейнеры

Убедитесь, что вы всё ещё находитесь в каталоге `gmonit`.

```bash
docker compose pull
# Скачивание новых версий образов

docker compose up --wait
# Перезапуск контейнеров с ожиданием их готовности
```

Или одной командой:

```bash
docker compose pull && docker compose up --wait
```

---

## Шаг 4: Если контейнеры не поднялись или в статусе `unhealthy`

Выполните:

```bash
docker compose stop
# Остановка всех контейнеров

docker compose start
# Перезапуск контейнеров
```

---

## Шаг 5: Проверьте, что обновление прошло успешно

1. Перейдите по адресу:

   ```
   https://demo.gmonit.ru/
   ```

   Убедитесь, что интерфейс доступен.

2. Проверьте версию коллектора:

   ```
   https://collector.demo.gmonit.ru/about
   ```

   Должен вернуться JSON с информацией о версии:

   ```json
   {
     "build/number": "v3-4181",
     ...
   }
   ```